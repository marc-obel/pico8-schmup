pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
function _init() 
	player = {
		x=50,
		y=100,
		direction=0
	}
	
	linecount = 60
	
	lines = {}
	trail = {}
end

function _update60()
	if (btn(0)) move_left()
	if (btn(1)) move_right()
	if (btn(2)) player.y -=1
	if (btn(3)) player.y +=1
	if (not btn(0) and not btn(1)) player.direction = 0 
	linecount -= 1
end

function _draw()
	cls(8)
	speed_line()
	draw_player(player.direction)
end

function move_left()
	player.x -=1
	player.direction = 1
end

function move_right()
	player.x +=1
	player.direction = 2
end

function draw_player(direction)
	if (direction == 0) sspr(0,0,20,18,player.x,player.y)
	if (direction == 1) sspr(0,20,20,18,player.x,player.y)
	if (direction == 2) sspr(21,20,20,18,player.x,player.y)
end

-- simplify this, have hard array of 20-40 lines and just put them at the top again when they y > 150
function speed_line()
	if (linecount == 0) do 
		linecount = 7
		-- add 2 or 3 lines, one on left and right and random y
		add(lines, {x = rnd(127), y=-30})
	end
	
	if (count(lines) == 0) return
	
	for i=1,count(lines),1 do
		lines[i].y += 4
		sspr(127,0,1,24,lines[i].x, lines[i].y)
	end
end

function pq(text)
	printh(text, "log")
end
__gfx__
0000000001100000000000000000000088888888888888888811118888888888888888111188888888888880000000000000000000000000000000000000000e
0000000017710000000000000000011111888888888888888177771888888888888881777718888888888880000000000000000000000000000000000000000e
0000000011110000000000000000177777188888888888888171171888888888888881711718888888888880000000000000000000000000000000000000000e
0000000177771000000000000001771771718888888888881177771888118811888811777711888888888880000000000000000000000000000000000000000e
0000001777777100000000000017717777711888888888881711117188171171811177111171888888888880000000000000000000000000000000000000000e
0000001711117100000000000017771111171888888811111177771111177771117711777711111188888880000000000000000000000000000000000000000e
0000011177771110000000001117777777771888888177771711117177171711777717111171777718888880000000000000000000000000000000000000000e
0000171777777171000000010017777777771188888171171771177171177771117717711771711718888880000000000000000000000000000000000000000e
0001717711117717100000000017777777771010888177171771177177177771717717711771717718888880000000000000000000000000000000000000000e
0017717111111717710000000001777777710000888817771771177177177777117717711771777188888880000000000000000000000000000000000000000e
0171717111111717171000000000177777100000888881771771171111111111111111711771771888888880000000000000000000000000000000000000000e
1711717711117717117100000000011111000000888888171771171188817117188811711771718888888880000000000000000000000000000000000000000e
1777771717717177777100000000001001000000888888811171171188881771888811711711188888888880000000000000000000000000000000000000000e
0111117171171711111000000000001001000000888888881711117188888118888817111171888888888880000000000000000000000000000000000000000e
0000001777777100000000000000001001000000888888881777777188888888888817777771888888888880000000000000000000000000000000000000000e
0000000171171000000000000000000000000000888888888177771888888888888881777718888888888880000000000000000000000000000000000000000e
0000000177771000000000000000000000000000888888888811118888888888888888111188888888888888888888888800000000000000000000000000000e
0000000011110000000000000000000000000000888888888817718888888888888888177188888118888888811888888800000000000000000000000000000e
0000000000000000000000000000000000000000888888888881188888888888888888811888881771818818177188888800000000000000000000000000000e
0000000000000000000000000000000001000000888888888888888888888888888888888888817117171171711718888800000000000000000000000000000e
0000000001000000000000000000000017100000888888888888888888888888888888888881111111111111111111188800000000000000000000000000000e
0000000017100000000000000000000011100000888888888888888888888888811118888881771777111111777177188800000000000000000000000000000e
0000000011100000000000000000000177710000888888118888118888888888171771888888177717111111777771888800000000000000000000000000000e
0000000177710000000000000000001777710000888811771111771188888111177171111888811777711117717118888800000000000000000000000000000e
00000001777710000000000000000011111100008888117717717711888881177111177118888881117711771118888888000000000000000000000000000000
00000001111110000000000000000111777110008888117717717711888881177177177118888888881177118888888888000000000000000000000000000000
00000011777111000000000000011717777711008888111711117111888881177177177118888888888811888888888888000000000000000000000000000000
00000117777717110000000001177177111717108888811111111118888881117111171118888888888811888888888888000000000000000000000000000000
00001717111771771100000017777171111117108888881118811188888888111111111188888888888888888888888888000000000000000000000000000000
00001711111171777710000177717171111111718888888118811888888888811188111888888888888888888888888888000000000000000000000000000000
00017111111171717771000117117177111117171888888888888888888888881188118888888888888888888888888888000000000000000000000000000000
00171711111771711711000001777177171717771888888888888888888888888888888888800000000000000000000000000000000000000000000000000000
00177717171771777100000000111717117171118888888888888888888888888888888888800000000000000000000000000000000000000000000000000000
00011171711717111000000000000177777710008888888888888888888888888888888888800000000000000000000000000000000000000000000000000000
00000017777771000000000000000017117100008880000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000001711710000000000000000017777100008880000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000001777710000000000000000001111000008880000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000111100000000000000000000000000008880000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000008880000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000008880000000000000000000000000000000000000000000000000000000000000000000000000000000000000
